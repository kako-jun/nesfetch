#!/usr/bin/env python3
"""
NES CHR-ROM生成ツール
8x8タイルのグラフィックスデータを生成
"""

import struct

# CHR-ROMは8KB（8192バイト）
CHR_SIZE = 8192
chr_data = bytearray(CHR_SIZE)

# 8x8フォントデータ（簡易版ASCIIフォント）
# 各文字は8バイト（8行 x 8ピクセル）で定義
font_data = {
    # 空白とシンボル
    0x00: [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],  # 空白
    0x01: [0x3C, 0x42, 0x81, 0x81, 0x81, 0x81, 0x42, 0x3C],  # ボックス

    # A-Z (0x21-0x3A に配置)
    0x21: [0x18, 0x24, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x42],  # A
    0x22: [0x7C, 0x42, 0x42, 0x7C, 0x42, 0x42, 0x42, 0x7C],  # B
    0x23: [0x3C, 0x42, 0x80, 0x80, 0x80, 0x80, 0x42, 0x3C],  # C
    0x24: [0x78, 0x44, 0x42, 0x42, 0x42, 0x42, 0x44, 0x78],  # D
    0x25: [0x7E, 0x40, 0x40, 0x7C, 0x40, 0x40, 0x40, 0x7E],  # E
    0x26: [0x7E, 0x40, 0x40, 0x7C, 0x40, 0x40, 0x40, 0x40],  # F
    0x27: [0x3C, 0x42, 0x80, 0x80, 0x8E, 0x82, 0x42, 0x3C],  # G
    0x28: [0x42, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x42, 0x42],  # H
    0x29: [0x3E, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x3E],  # I
    0x2A: [0x1F, 0x04, 0x04, 0x04, 0x04, 0x44, 0x44, 0x38],  # J
    0x2B: [0x42, 0x44, 0x48, 0x70, 0x48, 0x44, 0x42, 0x42],  # K
    0x2C: [0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x7E],  # L
    0x2D: [0x82, 0xC6, 0xAA, 0x92, 0x82, 0x82, 0x82, 0x82],  # M
    0x2E: [0x42, 0x62, 0x52, 0x4A, 0x46, 0x42, 0x42, 0x42],  # N
    0x2F: [0x3C, 0x42, 0x81, 0x81, 0x81, 0x81, 0x42, 0x3C],  # O
    0x30: [0x7C, 0x42, 0x42, 0x42, 0x7C, 0x40, 0x40, 0x40],  # P
    0x31: [0x3C, 0x42, 0x81, 0x81, 0x81, 0x8A, 0x44, 0x3A],  # Q
    0x32: [0x7C, 0x42, 0x42, 0x42, 0x7C, 0x48, 0x44, 0x42],  # R
    0x33: [0x3C, 0x42, 0x40, 0x30, 0x0C, 0x02, 0x42, 0x3C],  # S
    0x34: [0xFE, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10],  # T
    0x35: [0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x3C],  # U
    0x36: [0x82, 0x82, 0x44, 0x44, 0x28, 0x28, 0x10, 0x10],  # V
    0x37: [0x82, 0x82, 0x82, 0x82, 0x92, 0xAA, 0xC6, 0x82],  # W
    0x38: [0x42, 0x42, 0x24, 0x18, 0x18, 0x24, 0x42, 0x42],  # X
    0x39: [0x82, 0x44, 0x28, 0x10, 0x10, 0x10, 0x10, 0x10],  # Y
    0x3A: [0x7E, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x7E],  # Z

    # 数字 0-9
    0x10: [0x3C, 0x46, 0x8A, 0x92, 0xA2, 0xC2, 0x42, 0x3C],  # 0
    0x11: [0x10, 0x30, 0x10, 0x10, 0x10, 0x10, 0x10, 0x38],  # 1
    0x12: [0x3C, 0x42, 0x02, 0x0C, 0x30, 0x40, 0x40, 0x7E],  # 2
    0x13: [0x3C, 0x42, 0x02, 0x1C, 0x02, 0x02, 0x42, 0x3C],  # 3
    0x14: [0x04, 0x0C, 0x14, 0x24, 0x44, 0x7E, 0x04, 0x04],  # 4
    0x15: [0x7E, 0x40, 0x40, 0x7C, 0x02, 0x02, 0x42, 0x3C],  # 5
    0x16: [0x1C, 0x20, 0x40, 0x7C, 0x42, 0x42, 0x42, 0x3C],  # 6
    0x17: [0x7E, 0x02, 0x04, 0x08, 0x10, 0x10, 0x10, 0x10],  # 7
    0x18: [0x3C, 0x42, 0x42, 0x3C, 0x42, 0x42, 0x42, 0x3C],  # 8
    0x19: [0x3C, 0x42, 0x42, 0x42, 0x3E, 0x02, 0x04, 0x38],  # 9

    # 記号
    0x3B: [0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x18, 0x18],  # :
    0x3C: [0x00, 0x00, 0x00, 0x7E, 0x00, 0x00, 0x00, 0x00],  # -
    0x3D: [0x00, 0x08, 0x1C, 0x3E, 0x1C, 0x08, 0x00, 0x00],  # >
    0x3E: [0x00, 0x10, 0x38, 0x7C, 0x38, 0x10, 0x00, 0x00],  # <
    0x3F: [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],  # スペース
}

# 各ゲーム機のロゴタイルデータ
# 各ロゴは0x40 + (logo_id * 0x10)から始まる16タイル分を使用

# 0: NES/ファミコン風ロゴ
nes_console_logo = {
    0x40: [0xFF, 0x81, 0x81, 0x99, 0x99, 0x81, 0x81, 0xFF],
    0x41: [0x18, 0x24, 0x42, 0x42, 0x42, 0x42, 0x24, 0x18],
    0x42: [0x3C, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x3C],
    0x43: [0x7E, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x42, 0x7E],
}

# 1: SNES/スーパーファミコン風
snes_logo = {
    0x50: [0xFE, 0x82, 0x82, 0x82, 0xFE, 0x80, 0x80, 0x80],
    0x51: [0x3C, 0x42, 0x80, 0x80, 0x80, 0x42, 0x3C, 0x00],
    0x52: [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
    0x53: [0x42, 0x42, 0x24, 0x18, 0x18, 0x24, 0x42, 0x42],
}

# 2: Nintendo 64風
n64_logo = {
    0x60: [0x42, 0x62, 0x52, 0x4A, 0x46, 0x42, 0x42, 0x00],
    0x61: [0x18, 0x24, 0x24, 0x24, 0x24, 0x24, 0x18, 0x00],
    0x62: [0x3C, 0x42, 0x02, 0x1C, 0x20, 0x40, 0x7E, 0x00],
    0x63: [0x00, 0x18, 0x24, 0x42, 0x7E, 0x42, 0x42, 0x00],
}

# 3: GameCube風
gamecube_logo = {
    0x70: [0x3C, 0x42, 0x42, 0x42, 0x42, 0x42, 0x3C, 0x00],
    0x71: [0x18, 0x24, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x00],
    0x72: [0x7C, 0x42, 0x42, 0x7C, 0x42, 0x42, 0x7C, 0x00],
    0x73: [0x3C, 0x42, 0x80, 0x80, 0x80, 0x42, 0x3C, 0x00],
}

# 4: Wii風
wii_logo = {
    0x80: [0x82, 0x44, 0x28, 0x10, 0x28, 0x44, 0x82, 0x00],
    0x81: [0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00],
    0x82: [0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00],
    0x83: [0x7E, 0x42, 0x42, 0x42, 0x42, 0x42, 0x7E, 0x00],
}

# 5: Game Boy風
gameboy_logo = {
    0x90: [0xFF, 0x81, 0x81, 0xBD, 0xBD, 0x81, 0x81, 0xFF],
    0x91: [0x00, 0x3C, 0x42, 0x42, 0x42, 0x42, 0x3C, 0x00],
    0x92: [0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00],
    0x93: [0x00, 0x7E, 0x40, 0x40, 0x7C, 0x40, 0x7E, 0x00],
}

# 6: GBA風
gba_logo = {
    0xA0: [0x7E, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x42, 0x00],
    0xA1: [0x18, 0x24, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x00],
    0xA2: [0x3C, 0x42, 0x80, 0x80, 0x80, 0x42, 0x3C, 0x00],
    0xA3: [0x00, 0x3C, 0x42, 0x5A, 0x5A, 0x42, 0x3C, 0x00],
}

# 7: Nintendo DS風
nds_logo = {
    0xB0: [0x42, 0x62, 0x52, 0x4A, 0x46, 0x42, 0x42, 0x00],
    0xB1: [0x3C, 0x42, 0x42, 0x42, 0x42, 0x42, 0x3C, 0x00],
    0xB2: [0x3C, 0x42, 0x40, 0x30, 0x0C, 0x02, 0x7E, 0x00],
    0xB3: [0xFF, 0x81, 0x81, 0x81, 0x81, 0x81, 0xFF, 0x00],
}

# 8-11: PlayStation 1-4風ロゴ
ps1_logo = {
    0xC0: [0x7C, 0x42, 0x42, 0x7C, 0x40, 0x40, 0x40, 0x00],
    0xC1: [0x3C, 0x42, 0x40, 0x30, 0x0C, 0x02, 0x42, 0x3C],
    0xC2: [0x00, 0x7E, 0x42, 0x42, 0x42, 0x42, 0x7E, 0x00],
    0xC3: [0x00, 0x42, 0x24, 0x18, 0x18, 0x24, 0x42, 0x00],
}

ps2_logo = {
    0xD0: [0x7C, 0x42, 0x42, 0x7C, 0x40, 0x40, 0x40, 0x00],
    0xD1: [0x3C, 0x42, 0x40, 0x30, 0x0C, 0x02, 0x42, 0x3C],
    0xD2: [0x3C, 0x42, 0x02, 0x1C, 0x02, 0x02, 0x42, 0x3C],
    0xD3: [0x00, 0x3C, 0x42, 0x42, 0x42, 0x42, 0x3C, 0x00],
}

ps3_logo = {
    0xE0: [0x7C, 0x42, 0x42, 0x7C, 0x40, 0x40, 0x40, 0x00],
    0xE1: [0x3C, 0x42, 0x40, 0x30, 0x0C, 0x02, 0x42, 0x3C],
    0xE2: [0x3C, 0x42, 0x02, 0x1C, 0x02, 0x42, 0x3C, 0x00],
    0xE3: [0x00, 0x18, 0x3C, 0x7E, 0x7E, 0x3C, 0x18, 0x00],
}

ps4_logo = {
    0xF0: [0x7C, 0x42, 0x42, 0x7C, 0x40, 0x40, 0x40, 0x00],
    0xF1: [0x3C, 0x42, 0x40, 0x30, 0x0C, 0x02, 0x42, 0x3C],
    0xF2: [0x04, 0x0C, 0x14, 0x24, 0x7E, 0x04, 0x04, 0x00],
    0xF3: [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
}

# 12-14: SEGA Genesis, Saturn, Dreamcast風
genesis_logo = {
    0x140: [0x3C, 0x42, 0x40, 0x30, 0x0C, 0x02, 0x42, 0x3C],
    0x141: [0x7E, 0x40, 0x40, 0x7C, 0x40, 0x40, 0x7E, 0x00],
    0x142: [0x3C, 0x42, 0x80, 0x8E, 0x82, 0x42, 0x3C, 0x00],
    0x143: [0x18, 0x24, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x00],
}

saturn_logo = {
    0x150: [0x3C, 0x42, 0x40, 0x30, 0x0C, 0x02, 0x42, 0x3C],
    0x151: [0x18, 0x24, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x00],
    0x152: [0xFE, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00],
    0x153: [0x3C, 0x42, 0x81, 0x81, 0x81, 0x42, 0x3C, 0x00],
}

dreamcast_logo = {
    0x160: [0x3C, 0x42, 0x42, 0x42, 0x42, 0x42, 0x3C, 0x00],
    0x161: [0x00, 0x18, 0x3C, 0x7E, 0x7E, 0x3C, 0x18, 0x00],
    0x162: [0xFF, 0x81, 0xBD, 0xA5, 0xA5, 0xBD, 0x81, 0xFF],
    0x163: [0x42, 0x42, 0x24, 0x18, 0x18, 0x24, 0x42, 0x42],
}

# 15-16: Xbox, Xbox 360風
xbox_logo = {
    0x170: [0x42, 0x42, 0x24, 0x18, 0x18, 0x24, 0x42, 0x42],
    0x171: [0x3C, 0x42, 0x81, 0x81, 0x81, 0x42, 0x3C, 0x00],
    0x172: [0x00, 0x18, 0x3C, 0x7E, 0x7E, 0x3C, 0x18, 0x00],
    0x173: [0xFF, 0x81, 0x81, 0x81, 0x81, 0x81, 0xFF, 0x00],
}

xbox360_logo = {
    0x180: [0x42, 0x42, 0x24, 0x18, 0x18, 0x24, 0x42, 0x42],
    0x181: [0x3C, 0x42, 0x81, 0x81, 0x81, 0x42, 0x3C, 0x00],
    0x182: [0x3C, 0x42, 0x02, 0x1C, 0x02, 0x02, 0x42, 0x3C],
    0x183: [0x18, 0x24, 0x24, 0x24, 0x24, 0x24, 0x18, 0x00],
}

# 17-19: Atari, PC Engine, Neo Geo風
atari_logo = {
    0x190: [0x18, 0x24, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x00],
    0x191: [0xFE, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00],
    0x192: [0x18, 0x24, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x00],
    0x193: [0xFF, 0x81, 0x81, 0xBD, 0xBD, 0x81, 0x81, 0xFF],
}

pcengine_logo = {
    0x1A0: [0x7C, 0x42, 0x42, 0x7C, 0x40, 0x40, 0x40, 0x00],
    0x1A1: [0x3C, 0x42, 0x80, 0x80, 0x80, 0x42, 0x3C, 0x00],
    0x1A2: [0x7E, 0x40, 0x40, 0x7C, 0x40, 0x40, 0x7E, 0x00],
    0x1A3: [0xFF, 0x81, 0x81, 0x81, 0x81, 0x81, 0xFF, 0x00],
}

neogeo_logo = {
    0x1B0: [0x42, 0x62, 0x52, 0x4A, 0x46, 0x42, 0x42, 0x00],
    0x1B1: [0x7E, 0x40, 0x40, 0x7C, 0x40, 0x40, 0x7E, 0x00],
    0x1B2: [0x3C, 0x42, 0x81, 0x81, 0x81, 0x42, 0x3C, 0x00],
    0x1B3: [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
}


def write_tile(tile_index, pattern):
    """
    8x8タイルデータをCHR-ROMに書き込む
    NESのタイルフォーマット：16バイト/タイル
    - 最初の8バイト: bit plane 0
    - 次の8バイト: bit plane 1
    """
    offset = tile_index * 16

    for i in range(8):
        # bit plane 0 (下位ビット)
        chr_data[offset + i] = pattern[i]
        # bit plane 1 (上位ビット) - とりあえず0
        chr_data[offset + 8 + i] = 0x00


def main():
    # フォントデータを書き込み
    for tile_id, pattern in font_data.items():
        write_tile(tile_id, pattern)

    # ゲーム機ロゴデータを書き込み（20種類）
    all_logos = [
        nes_console_logo,  # 0: NES
        snes_logo,         # 1: SNES
        n64_logo,          # 2: N64
        gamecube_logo,     # 3: GameCube
        wii_logo,          # 4: Wii
        gameboy_logo,      # 5: Game Boy
        gba_logo,          # 6: GBA
        nds_logo,          # 7: NDS
        ps1_logo,          # 8: PS1
        ps2_logo,          # 9: PS2
        ps3_logo,          # 10: PS3
        ps4_logo,          # 11: PS4
        genesis_logo,      # 12: Genesis
        saturn_logo,       # 13: Saturn
        dreamcast_logo,    # 14: Dreamcast
        xbox_logo,         # 15: Xbox
        xbox360_logo,      # 16: Xbox 360
        atari_logo,        # 17: Atari
        pcengine_logo,     # 18: PC Engine
        neogeo_logo        # 19: Neo Geo
    ]

    for logo in all_logos:
        for tile_id, pattern in logo.items():
            write_tile(tile_id, pattern)

    # CHR-ROMファイルを出力
    with open('chr.bin', 'wb') as f:
        f.write(chr_data)

    print(f"CHR-ROM created: chr.bin ({len(chr_data)} bytes)")
    print(f"Total logos: {len(all_logos)}")


if __name__ == '__main__':
    main()
