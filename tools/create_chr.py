#!/usr/bin/env python3
"""
NES CHR-ROM生成ツール - 3×4タイル（24×32ピクセル）版
実際のロゴに忠実なデザイン
"""

CHR_SIZE = 8192
chr_data = bytearray(CHR_SIZE)

# フォントデータ
font_data = {
    0x00: [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],
    # A-Z
    0x21: [0x18, 0x24, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x42],
    0x22: [0x7C, 0x42, 0x42, 0x7C, 0x42, 0x42, 0x42, 0x7C],
    0x23: [0x3C, 0x42, 0x80, 0x80, 0x80, 0x80, 0x42, 0x3C],
    0x24: [0x78, 0x44, 0x42, 0x42, 0x42, 0x42, 0x44, 0x78],
    0x25: [0x7E, 0x40, 0x40, 0x7C, 0x40, 0x40, 0x40, 0x7E],
    0x26: [0x7E, 0x40, 0x40, 0x7C, 0x40, 0x40, 0x40, 0x40],
    0x27: [0x3C, 0x42, 0x80, 0x80, 0x8E, 0x82, 0x42, 0x3C],
    0x28: [0x42, 0x42, 0x42, 0x7E, 0x42, 0x42, 0x42, 0x42],
    0x29: [0x3E, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x3E],
    0x2A: [0x1F, 0x04, 0x04, 0x04, 0x04, 0x44, 0x44, 0x38],
    0x2B: [0x42, 0x44, 0x48, 0x70, 0x48, 0x44, 0x42, 0x42],
    0x2C: [0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x7E],
    0x2D: [0x82, 0xC6, 0xAA, 0x92, 0x82, 0x82, 0x82, 0x82],
    0x2E: [0x42, 0x62, 0x52, 0x4A, 0x46, 0x42, 0x42, 0x42],
    0x2F: [0x3C, 0x42, 0x81, 0x81, 0x81, 0x81, 0x42, 0x3C],
    0x30: [0x7C, 0x42, 0x42, 0x42, 0x7C, 0x40, 0x40, 0x40],
    0x31: [0x3C, 0x42, 0x81, 0x81, 0x81, 0x8A, 0x44, 0x3A],
    0x32: [0x7C, 0x42, 0x42, 0x42, 0x7C, 0x48, 0x44, 0x42],
    0x33: [0x3C, 0x42, 0x40, 0x30, 0x0C, 0x02, 0x42, 0x3C],
    0x34: [0xFE, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10],
    0x35: [0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x3C],
    0x36: [0x82, 0x82, 0x44, 0x44, 0x28, 0x28, 0x10, 0x10],
    0x37: [0x82, 0x82, 0x82, 0x82, 0x92, 0xAA, 0xC6, 0x82],
    0x38: [0x42, 0x42, 0x24, 0x18, 0x18, 0x24, 0x42, 0x42],
    0x39: [0x82, 0x44, 0x28, 0x10, 0x10, 0x10, 0x10, 0x10],
    0x3A: [0x7E, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x7E],
    # 数字
    0x10: [0x3C, 0x46, 0x8A, 0x92, 0xA2, 0xC2, 0x42, 0x3C],
    0x11: [0x10, 0x30, 0x10, 0x10, 0x10, 0x10, 0x10, 0x38],
    0x12: [0x3C, 0x42, 0x02, 0x0C, 0x30, 0x40, 0x40, 0x7E],
    0x13: [0x3C, 0x42, 0x02, 0x1C, 0x02, 0x02, 0x42, 0x3C],
    0x14: [0x04, 0x0C, 0x14, 0x24, 0x44, 0x7E, 0x04, 0x04],
    0x15: [0x7E, 0x40, 0x40, 0x7C, 0x02, 0x02, 0x42, 0x3C],
    0x16: [0x1C, 0x20, 0x40, 0x7C, 0x42, 0x42, 0x42, 0x3C],
    0x17: [0x7E, 0x02, 0x04, 0x08, 0x10, 0x10, 0x10, 0x10],
    0x18: [0x3C, 0x42, 0x42, 0x3C, 0x42, 0x42, 0x42, 0x3C],
    0x19: [0x3C, 0x42, 0x42, 0x42, 0x3E, 0x02, 0x04, 0x38],
    # 記号
    0x3B: [0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x18, 0x18],
    0x3C: [0x00, 0x00, 0x00, 0x7E, 0x00, 0x00, 0x00, 0x00],
    0x3D: [0x00, 0x08, 0x1C, 0x3E, 0x1C, 0x08, 0x00, 0x00],
    0x3E: [0x00, 0x10, 0x38, 0x7C, 0x38, 0x10, 0x00, 0x00],
}

# ロゴデータ（3×4タイル = 12タイル/ロゴ）
# Row 0: タイル 0-2、Row 1: タイル 3-5、Row 2: タイル 6-8、Row 3: タイル 9-11

# NES - ファミコン本体
nes_logo = [
    [0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF],
    [0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF],
    [0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF],
    [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
    [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
    [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
    [0xFF, 0x80, 0xBE, 0xAA, 0xAA, 0xBE, 0x80, 0xFF],
    [0xFF, 0xBE, 0x82, 0x82, 0x82, 0x82, 0xBE, 0xFF],
    [0xFF, 0x80, 0xBE, 0xAA, 0xAA, 0xBE, 0x80, 0xFF],
    [0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF],
    [0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF],
    [0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF],
]

# SNES - カラフルなボタン
snes_logo = [
    [0x00, 0x3C, 0x7E, 0xFF, 0xFF, 0x7E, 0x3C, 0x00],
    [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],
    [0x00, 0x3C, 0x7E, 0xFF, 0xFF, 0x7E, 0x3C, 0x00],
    [0x00, 0x3C, 0x42, 0x81, 0x81, 0x42, 0x3C, 0x00],
    [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
    [0x00, 0x3C, 0x42, 0x81, 0x81, 0x42, 0x3C, 0x00],
    [0x00, 0x3C, 0x7E, 0xFF, 0xFF, 0x7E, 0x3C, 0x00],
    [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00],
    [0x00, 0x3C, 0x7E, 0xFF, 0xFF, 0x7E, 0x3C, 0x00],
    [0x00, 0x00, 0x3C, 0x7E, 0x7E, 0x3C, 0x00, 0x00],
    [0x00, 0x3C, 0x7E, 0xFF, 0xFF, 0x7E, 0x3C, 0x00],
    [0x00, 0x00, 0x3C, 0x7E, 0x7E, 0x3C, 0x00, 0x00],
]

# 残りのロゴは簡易版（後で改善可能）
def create_simple_logo():
    return [
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
        [0xFF, 0x81, 0x99, 0xBD, 0xBD, 0x99, 0x81, 0xFF],
    ]

all_logos = [
    nes_logo, snes_logo,
    create_simple_logo(), create_simple_logo(), create_simple_logo(),
    create_simple_logo(), create_simple_logo(), create_simple_logo(),
    create_simple_logo(), create_simple_logo(), create_simple_logo(),
    create_simple_logo(), create_simple_logo(), create_simple_logo(),
    create_simple_logo(), create_simple_logo(), create_simple_logo(),
    create_simple_logo(), create_simple_logo(), create_simple_logo(),
    create_simple_logo(), create_simple_logo(), create_simple_logo(),
    create_simple_logo(), create_simple_logo(), create_simple_logo(),
    create_simple_logo(), create_simple_logo(), create_simple_logo(),
]

def write_tile(tile_index, pattern):
    offset = tile_index * 16
    for i in range(8):
        chr_data[offset + i] = pattern[i]
        chr_data[offset + 8 + i] = 0x00

def main():
    for tile_id, pattern in font_data.items():
        write_tile(tile_id, pattern)
    for logo_idx, logo in enumerate(all_logos):
        base_tile = 0x40 + (logo_idx * 12)
        for tile_offset, pattern in enumerate(logo):
            write_tile(base_tile + tile_offset, pattern)
    with open('chr.bin', 'wb') as f:
        f.write(chr_data)
    print(f'CHR-ROM created: chr.bin ({len(chr_data)} bytes)')
    print(f'Total logos: {len(all_logos)}, Tiles used: {len(font_data) + len(all_logos) * 12}')

if __name__ == '__main__':
    main()
